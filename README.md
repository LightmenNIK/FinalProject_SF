# Тема Бриф 1. Агентство недвижимости
# Задача — разработать сервис для предсказания стоимости домов на основе истории предложений

Машинное обучение для оценки стоимости недвижимости по различным характеристикам объекта и локации.  
Проект включает обработку данных, построение моделей, отбор признаков, подбор гиперпараметров и проверку устойчивости на синтетических и аномальных данных.

## Содержание
- [Описание](#описание)
- [Используемые технологии](#используемые-технологии)
- [Структура проекта](#структура-проекта)
- [Этапы проекта](#этапы-проекта)
- [Результаты моделей](#результаты-моделей)
- [Генерация тестовых данных](#генерация-тестовых-данных)

## Описание

Исходный набор признаков: 

'status' — статус продажи;

'private pool' и 'PrivatePool' — наличие собственного бассейна;

'propertyType' — тип объекта недвижимости;

'street' — адрес объекта;

'baths' — количество ванных комнат;

'homeFacts' — сведения о строительстве объекта (содержит несколько типов сведений, влияющих на оценку объекта);

'fireplace' — наличие камина;

'city' — город;

'schools' — сведения о школах в районе;

'sqft' — площадь в футах;

'zipcode' — почтовый индекс;

'beds' — количество спален;

'state' — штат;

'stories' — количество этажей;

'mls-id' и 'MlsId' — идентификатор MLS (Multiple Listing Service, система мультилистинга);

'target' — цена объекта недвижимости (целевой признак, который необходимо спрогнозировать).

Используя исходные признаки выполены: 

1. Их обработка (Заполнение пропусков, удаление дубликатов)

2. Проектирование новых признаков: 

    'sqft' - площадь жилой зоны(кв.фут);

    'bath_count' - количество ванных комнат; 

    'lot_size_sqft' - площадь участка(кв.фут); 
    
    'price_per_sqft' - цена за кв.фут; 

    'age' - возраст постройки;

    'cooling_cod' - наличие системы охлаждения;

    'heat_baseboard', 'heat_central', 'heat_electric','heat_forced_air', 'heat_gas', 'heat_heat_pump', 'heat_oil','heat_other', 'heat_radiant', 'heat_refrigeration', 'heat_unknown','heat_wall' - группа признаков типа отопления;
    
    'avg_school_distance' - среднее расстояние до школы;
    
    'low_rating_count' - абсолютное значение школ с низким рейтингом;

    'good_to_bad_ratio' - соотношение хороших (рэйтинг>7) к плохим (<4) школ;
    
    'longitude' - геоданные;
    
    'distance_to_state_capital' - расстрояние до столицы штата

    'state_encoded' - штат (закодирован по колличеству повторений)

    'status_category_encoded','property_type_main_encoded', 'property_type_style_encoded','city_size_category_encoded' - группа категориальных признаков, закодированная в соответствии с целевым признаком 

Итоговая модель предсказывает логарифм цены (`log1p(price)`), используя 20 признаков, перечисленных выше

Финальная модель: **LightGBM + L2-регуляризация**

## Используемые технологии
- Python 3.10+
- pandas, numpy
- scikit-learn
- lightgbm
- matplotlib, seaborn, plotly
- pickle для сериализации

## Структура проекта
    Картинки
    FinalProject_ML_3-3.ipynb
    FinaProject_Cleaned and Fill_1-3.ipynb
    FinaProject_EDA_FeatEng_2-3.ipynb
    LGBMmodel_GS_L2.pkl
    output_file.html
    README.md
    
## Основные этапы проекта
1. Сбор и загрузка данных

    Получение исходного датафрейма (CSV)

2. Предобработка данных (EDA + очистка)

    Проверка пропусков, выбросов, распределений

    Преобразование целевой переменной (log1p(price) — логарифмирование)

    Масштабирование/нормализация

    Кодирование категориальных признаков (OneHot, Ordinal, Label)

3. Разделение на выборки

    Train/Test split (например, 80/20)

4. Выбор модели

    Выбор модели происходил по метрикам [MAE](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mean_absolute_error.html), [RMSE](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.root_mean_squared_error.html), [R²](https://ru.wikipedia.org/wiki/Коэффициент_детерминации)

5. Подбор гиперпараметров

    [GridSearchCV](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html) 

6. Отбор признаков

    По feature_importances_


7. Регуляризация

    Подбор параметра reg_lambda (L2-регуляризация в LGBM)

8. Сохранение модели

    pickle

9. Тестирование на новых/аномальных данных

    Генерация синтетических объектов

    Проверка стабильности и интерпретации предсказаний

10. Документация и визуализация

    Создание README.md, графиков, таблиц с метриками

## Результаты моделей

| Модель            | R² (Test) | RMSE (Test) | MAE (Test) |
| ----------------- | --------- | ----------- | ---------- |
| Linear Regression | 0.51      | 0.85        | 0.58       |
| Random Forest     | 0.86      | 0.45        | 0.18       |
| LightGBM (L2)     | **0.88**  | **0.41**    | **0.18**   |

## Генерация тестовых данных

Модель протестирована на:

    Реалистичных синтетических данных

    Аномальных объектах (огромные дома, дешёвые участки и др.)

Пример предсказания:

    Аномальный объект 1: лог-прогноз = 16.99 → Цена ≈ 23,809,127 у.е.

    Аномальный объект 2: лог-прогноз = 7.01  → Цена ≈ 1,105 у.е

    Аномальный объект 3: лог-прогноз = 17.18 → Цена ≈ 28,806,669 у.е.